function read_ini()
{
    if [ $# -lt 2 ];then
        echo 'Usage:ini <filename> <[section]> [<key>] [<newvalue>]'
        _exit
    fi
    _old=`cat $1`
    if [ "$3" = "" ];then
       sed -n "/\[$2\]/,/\[.*\]/{
           /^\[.*\]/d
           /^[ ]*$/d
           s/;.*$//
           p
           }" $1
    elif [ "$4" = "" ];then
       sed -n "/\[$2\]/,/\[.*\]/{
           /^\[.*\]/d
           /^[ ]*$/d
           s/;.*$//
           s/^[ |    ]*$3[|    ]*=[ |    ]*\(.*\)[ |    ]*/\1/p
           }" $1
    else
       if [ "$4" = "#" ];then
       sed -i "/\[$2\]/,/\[.*\]/{
           s/^[ |    ]*$3[ |    ]*=.*/ /
           }" $1
       else
       sed -i "/\[$2\]/,/\[.*\]/{    
           s/^[ |    ]*$3[ |    ]*=.*[ |    |.*]/$3=$4            /
           #s/^[ |    ]*$3[ |    ]*=[a-zA-Z0-9]*.[0-9]*.[0-9]*.[0-9]*/$3=$4/
           }" $1
    _new=`cat $1`
           if [ "$_new" = "$_old" ];then
           sed -i "/\[$2\]/,/\[.*\]/{
           s/^[ |      ]*$3[ |    ]*=.*/$3=$4/
           #s/^[ |     ]*$3[ | ]*=[a-zA-Z0-9]*.[0-9]*.[0-9]*.[0-9]*/$3=$4/
           }" $1
           fi
       fi
    fi
}